import{r,j as e,k as y}from"./index-C6a6N-4U.js";function N({user:x}){const[l,m]=r.useState(!1),[n,i]=r.useState([{id:"intro",role:"ai",text:"Hi! Tell me what you like to study and I will recommend modules and tutors."}]),[d,c]=r.useState(""),a=r.useRef(null);r.useEffect(()=>{a.current&&(a.current.scrollTop=a.current.scrollHeight)},[n,l]);const h=s=>{s.preventDefault();const t=d.trim();if(!t)return;const g={id:`u_${Date.now()}`,role:"user",text:t};i(o=>[...o,g]),c("");const{subjectHint:u,recommendedModules:b,recommendedTutors:p}=y(t,x?.id),f={id:`a_${Date.now()}`,role:"ai",text:`Here are some recommendations${u?` for ${u}`:""}:`,modules:b,tutors:p};setTimeout(()=>i(o=>[...o,f]),250)};return e.jsxs("div",{children:[e.jsx("button",{type:"button",onClick:()=>m(s=>!s),"aria-label":l?"Close AI Chatbot":"Open AI Chatbot",className:"fixed bottom-5 right-5 z-40 h-14 w-14 rounded-full bg-blue-600 text-white shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:e.jsx("span",{"aria-hidden":"true",className:"inline-block",children:"💬"})}),l&&e.jsxs("div",{role:"dialog","aria-label":"AI Chatbot","aria-modal":"true",className:"fixed bottom-24 right-5 z-40 w-80 max-h-[70vh] rounded-2xl border border-gray-200 bg-white shadow-xl grid grid-rows-[1fr_auto]",children:[e.jsx("div",{ref:a,className:"overflow-y-auto p-3 space-y-3",role:"log","aria-live":"polite",children:n.map(s=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`${s.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"} max-w-[85%] rounded-2xl px-3 py-2 text-sm shadow-sm`,role:"article","aria-label":s.role==="user"?"Student message":"AI response",children:[e.jsx("p",{children:s.text}),s.role==="ai"&&(s.modules?.length||s.tutors?.length)&&e.jsxs("div",{className:"mt-2 space-y-2",children:[s.modules?.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Recommended Modules"}),e.jsx("ul",{className:"mt-1 space-y-1",children:s.modules.map(t=>e.jsxs("li",{className:"rounded-md border border-gray-200 bg-white text-gray-900 px-2 py-1",children:[e.jsx("span",{className:"font-medium",children:t.title}),e.jsxs("span",{className:"ml-1 text-xs text-gray-600",children:["• ",t.subject," • ",t.level]})]},t.id))})]}),s.tutors?.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Recommended Tutors"}),e.jsx("ul",{className:"mt-1 space-y-1",children:s.tutors.map(t=>e.jsxs("li",{className:"rounded-md border border-gray-200 bg-white text-gray-900 px-2 py-1",children:[e.jsx("span",{className:"font-medium",children:t.name}),e.jsxs("span",{className:"ml-1 text-xs text-gray-600",children:["• ",t.subject," • ⭐ ",t.rating]})]},t.id))})]})]})]})},s.id))}),e.jsxs("form",{onSubmit:h,className:"border-t border-gray-200 p-2 flex gap-2",children:[e.jsx("label",{htmlFor:"ai-draft",className:"sr-only",children:"Type your message"}),e.jsx("input",{id:"ai-draft",type:"text",className:"flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Type a preference… (e.g., I like Math)",value:d,onChange:s=>c(s.target.value)}),e.jsx("button",{type:"submit",className:"rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Send"})]})]})]})}export{N as F};
