import{r as l,n,a as p,j as e,q as b}from"./index-C6a6N-4U.js";function j({user:t}){const[r,o]=l.useState(null),[i,c]=l.useState(""),x=l.useMemo(()=>{const s=[...new Set(n.filter(a=>a.receiverId===t.id).map(a=>a.senderId))];return p.filter(a=>s.includes(a.id))},[t.id]),m=l.useMemo(()=>r?n.filter(s=>s.senderId===t.id&&s.receiverId===r.id||s.senderId===r.id&&s.receiverId===t.id).sort((s,a)=>new Date(s.timestamp)-new Date(a.timestamp)):[],[r,t.id]),g=s=>{if(s.preventDefault(),!i.trim()||!r)return;const a={senderId:t.id,receiverId:r.id,text:i.trim(),senderName:t.name,receiverName:r.name};b(a),c("")},u=s=>new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Messages"}),e.jsx("p",{className:"text-gray-600",children:"Communicate with your students."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Students"})}),e.jsx("div",{className:"divide-y divide-gray-200",children:x.map(s=>{const a=n.filter(d=>d.senderId===t.id&&d.receiverId===s.id||d.senderId===s.id&&d.receiverId===t.id).sort((d,h)=>new Date(h.timestamp)-new Date(d.timestamp))[0];return e.jsx("button",{onClick:()=>o(s),className:`w-full px-4 py-3 text-left hover:bg-gray-50 focus:outline-none focus:bg-gray-50 ${r?.id===s.id?"bg-blue-50":""}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.avatarUrl,alt:`${s.name} avatar`,className:"h-10 w-10 rounded-full ring-1 ring-gray-300"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.name}),a&&e.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[a.senderId===t.id?"You: ":"",a.text]})]})]})},s.id)})})]})}),e.jsx("div",{className:"lg:col-span-2",children:r?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 flex flex-col h-96",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:r.avatarUrl,alt:`${r.name} avatar`,className:"h-8 w-8 rounded-full ring-1 ring-gray-300"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Student"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:m.map(s=>e.jsx("div",{className:`flex ${s.senderId===t.id?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${s.senderId===t.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:[e.jsx("p",{className:"text-sm",children:s.text}),e.jsx("p",{className:`text-xs mt-1 ${s.senderId===t.id?"text-blue-100":"text-gray-500"}`,children:u(s.timestamp)})]})},s.id))}),e.jsx("form",{onSubmit:g,className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:i,onChange:s=>c(s.target.value),placeholder:"Type a message...",className:"flex-1 rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",disabled:!i.trim(),className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 h-96 flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-gray-500",children:"Select a student to start messaging"})})})})]})]})}export{j as default};
