import{r as s,a as W,e as X,j as e,L as b,t as Z}from"./index-yWr8wzxB.js";import{S as ee}from"./StudentProfileModal-Bg3rBU4T.js";function le({user:c}){const P=s.useMemo(()=>W.find(t=>t.id===c.id),[c.id]),[i,j]=s.useState("all"),[a,o]=s.useState(null),[I,f]=s.useState(!1),[L,m]=s.useState(!1),[$,N]=s.useState(!1),[y,E]=s.useState(null),[x,v]=s.useState(""),[u,w]=s.useState(""),[g,S]=s.useState(""),[h,C]=s.useState(""),[d,k]=s.useState("Online"),[p,R]=s.useState(""),[T,D]=s.useState([]),[M,F]=s.useState(""),r=X.filter(t=>t.tutorId===c.id),A=r.filter(t=>i==="all"?!0:t.status===i),O=(t,l)=>{Z(t,l),j(n=>n)},U=t=>{if(t.status!=="upcoming")return!1;const l=new Date(`${t.date} ${t.time}`),n=new Date;return l.getTime()-n.getTime()<=900*1e3},J=t=>{o(t),f(!0)},_=t=>{o(t),v(t.date),w(t.time),m(!0)},z=t=>{E(t),N(!0)},V=()=>{a&&x&&u&&(alert(`Session rescheduled to ${x} at ${u}`),m(!1),o(null))},Y=t=>{t.meetingRoomId?window.open(`/meeting/${t.meetingRoomId}`,"_blank"):alert("No meeting link available for this session.")},q=r.filter(t=>t.status==="completed").reduce((t,l)=>t+(l.earnings||0),0),B=r.filter(t=>t.status==="upcoming").length,G=r.filter(t=>t.status==="completed").length,H=()=>{if(!g||!h||d==="Physical"&&!p){alert("Please fill in all required fields.");return}const t=d==="Online"?"Online (link will be generated)":p;D(l=>[...l,{date:g,startTime:h,endTime:M,type:d,location:t}]),S(""),C(""),k("Online"),R("")};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Manage Sessions"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"View and manage your tutoring sessions"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Filter:"}),e.jsxs("select",{value:i,onChange:t=>j(t.target.value),className:"rounded-lg border border-gray-300 px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Sessions"}),e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold text-xl",children:"📅"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:B})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-green-100 flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 font-semibold text-xl",children:"✓"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:G})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-yellow-100 flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-600 font-semibold text-xl",children:"$"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Earnings"}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:["RM ",q]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-purple-100 flex items-center justify-center",children:e.jsx("span",{className:"text-purple-600 font-semibold text-xl",children:"★"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Rating"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:P.rating})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Sessions"})}),A.length?e.jsx("div",{className:"divide-y divide-gray-200",children:A.map(t=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-start gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.topic}),e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${t.status==="upcoming"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:t.status==="upcoming"?"Upcoming":"Completed"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Student:"}),e.jsx("button",{onClick:()=>z(t.studentId),className:"ml-1 text-blue-600 hover:text-blue-800 hover:underline font-medium",children:t.studentName})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Subject:"})," ",t.subject]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Date & Time:"})," ",t.date," at ",t.time]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Duration:"})," ",t.duration," minutes"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Price:"})," RM ",t.price]}),t.status==="completed"&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Earnings:"})," RM ",t.earnings]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Meeting Room:"})," ",t.meetingRoomId]}),t.status==="completed"&&t.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Rating:"}),e.jsx("div",{className:"flex",children:[...Array(5)].map((l,n)=>e.jsx("span",{className:`text-sm ${n<t.rating?"text-yellow-400":"text-gray-300"}`,children:"⭐"},n))}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",t.rating,"/5)"]})]})]})]}),t.sessionNotes&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Session Notes:"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.sessionNotes})]}),t.status==="completed"&&t.sessionSummary&&e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-green-700 mb-1",children:"Session Summary:"}),e.jsx("p",{className:"text-sm text-green-600",children:t.sessionSummary})]}),t.status==="completed"&&t.feedback&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-blue-700 mb-1",children:"Student Feedback:"}),e.jsxs("p",{className:"text-sm text-blue-600 italic",children:['"',t.feedback,'"']})]})]})})}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[t.status==="upcoming"&&e.jsxs(e.Fragment,{children:[U(t)?e.jsx("button",{onClick:()=>Y(t),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors",children:"Join Meeting"}):e.jsx("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-4 py-2 rounded-lg text-sm font-semibold cursor-not-allowed",children:"Join Meeting (15 min before)"}),e.jsx(b,{to:"/tutor/messages",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors inline-block text-center",children:"Contact Student"}),t.canReschedule&&e.jsx("button",{onClick:()=>_(t),className:"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors",children:"Reschedule"})]}),t.status==="completed"&&e.jsxs(e.Fragment,{children:[t.followUpNeeded&&e.jsx(b,{to:"/tutor/messages",className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors inline-block text-center",children:"Follow-up Needed"}),e.jsx(b,{to:"/tutor/messages",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors inline-block text-center",children:"Contact Student"})]}),e.jsx("button",{onClick:()=>J(t),className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors",children:"View Details"}),t.status==="upcoming"&&e.jsx("button",{onClick:()=>O(t.id,"completed"),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors",children:"Mark Complete"})]})]})},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 text-lg",children:i==="all"?"No sessions found.":`No ${i} sessions found.`}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:i==="upcoming"?"Check back later for new bookings":"Your completed sessions will appear here"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm mt-8 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Manage Availability"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsx("input",{type:"date",value:g,onChange:t=>S(t.target.value),className:"border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"time",value:h,onChange:t=>C(t.target.value),className:"border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"time",value:M,onChange:t=>F(t.target.value),className:"border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("select",{value:d,onChange:t=>k(t.target.value),className:"border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"Online",children:"Online"}),e.jsx("option",{value:"Physical",children:"Physical"})]}),d==="Physical"&&e.jsx("input",{type:"text",placeholder:"Location",value:p,onChange:t=>R(t.target.value),className:"border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("button",{onClick:H,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg text-sm font-semibold",children:"Add Availability"}),T.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Your Available Slots"}),e.jsx("ul",{className:"divide-y divide-gray-200",children:T.map((t,l)=>e.jsxs("li",{className:"py-2 flex justify-between items-center",children:[e.jsxs("span",{className:"text-gray-700",children:[t.date," at ",t.time," - ",t.location]}),e.jsx("button",{onClick:()=>D(n=>n.filter((K,Q)=>Q!==l)),className:"text-red-500 hover:text-red-700 text-sm",children:"Remove"})]},l))})]})]})]}),I&&a&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Session Details"}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Topic:"})," ",a.topic]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Subject:"})," ",a.subject]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Date & Time:"})," ",a.date," at ",a.time]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Student:"})," ",a.studentName]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Location:"})," ",a.meetingRoomId||"N/A"]}),e.jsx("div",{className:"mt-6 flex justify-end gap-3",children:e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded-lg",children:"Close"})})]})}),L&&a&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Reschedule Session"}),e.jsx("input",{type:"date",value:x,onChange:t=>v(t.target.value),className:"border rounded-lg px-3 py-2 w-full mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"time",value:u,onChange:t=>w(t.target.value),className:"border rounded-lg px-3 py-2 w-full mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:V,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"Save"})]})]})}),$&&y&&e.jsx(ee,{studentId:y,onClose:()=>N(!1)})]})})}export{le as default};
